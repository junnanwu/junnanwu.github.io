# Linux简介

## 什么是Linux

Linus Torvalds在上学时就开发了第一版Linux内核。起初他只是想仿造一款Unix系统而已，因为当时Unix操作系统在很多大学都很流行。

Linux可以划分为以下四个部分：

- Linux内核
- GNU工具
- 图形化桌面环境
- 应用软件

### Linux内核

内核主要负责以下四种功能：

- 系统内存管理
- 软件程序管理
- 硬件设备管理
- 文件系统管理

#### 系统内存管理

内核不仅管理服务器上的可用物理内存，还可以创建和管理虚拟内存。

内核通过**硬件上的存储空间**来实现虚拟内存，这块区域成为交换空间（swap space）。内核不断地在交换空间和实际的物理内存之间反复交换虚拟内存中的内容。这使得系统以为它拥有比物理内存更多的可用内存。

内存存储单元按组划分成很多块，这些块称作页面（page）。内核将每个内存页面放在物理内存或交换空间。然后，内核会维护一个内存页面表，指明哪些页面位于物理内存内，哪些页面被换到了磁盘上。

内核会记录哪些内存页面正在使用中，**并自动把一段时间未访问的内存页面复制到交换空间区域**（称为换出，swapping out）—— 即使还有可用内存。当程序要访问一个已被换出的内存页面时，内核必须从物理内存换出另外一个内存页面给它让出空间，然后从交换空间换入请求的内存页面。显然，这个过程要花费时间，拖慢运行中的进程。只要Linux系统在运行，为运行中的程序换出内存页面的过程就不会停歇。

#### 软件程序管理

Linux操作系统将运行中的程序称为进程。

内核启动了第一个进程（称为init进程）来启动任何其他进程当内核启动时，它会将init进程加载到虚拟内存中。内核在启动任何其他进程时，都会在虚拟内存中给新进程分配一块专有区域来存储该进程用到的数据和代码。

一些Linux采用/etc/init.d目录，将开机时启动或停止某个应用的脚本放在这个目录下。

```
ll /etc/init.d/
总用量 60
-rwxr-xr-x 1 root root 10867 5月  23 2020 clickhouse-server
-rw-r--r-- 1 root root 18281 5月  22 2020 functions
-rwxr-xr-x 1 root root  4569 5月  22 2020 netconsole
-rwxr-xr-x 1 root root  7928 5月  22 2020 network
-rw-r--r-- 1 root root  1160 2月   3 2021 README
-rwxr-xr-x 1 root root  5840 8月  11 13:59 srepagent
```

#### 硬件设备管理

内核的另一职责是管理硬件设备。任何Linux系统需要与之通信的设备，都需要在内核代码中加入其驱动程序代码。驱动程序代码相当于应用程序和硬件设备的中间人，允许内核与设备之间交换数据。在Linux内核中有两种方法用于插入设备驱动代码:

- 编译进内核的设备驱动代码
- 可插入内核的设备驱动模块

开发人员提出了内核模块的概念。它允许将驱动代码插入到运行中的内核而无需重新编译内核。同时，当设备不再使用时也可将内核模块从内核中移走。这种方式极大地简化和扩展了硬件设备在Linux上的使用。

Linux系统将硬件设备当成特殊的文件，称为设备文件。设备文件有3种分类: 

- 字符型设备文件

  字符型设备文件是指处理数据时每次只能处理一个字符的设备。大多数类型的调制解调器和终端都是作为字符型设备文件创建的。

- 块设备文件

  块设备文件是指处理数据时每次能处理大块数据的设备， 比如硬盘。

- 网络设备文件

  网络设备文件是指采用数据包发送和接收数据的设备，包括各种网卡和一个特殊的回环设备。这个回环设备允许Linux系统使用常见的网络编程协议同自身通信。

Linux为系统上的每个设备都创建一种称为节点的特殊文件。与设备的所有通信都通过设备节点完成。每个节点都有唯一的数值对供Linux内核标识它。数值对包括一个主设备号和一 个次设备号。类似的设备被划分到同样的主设备号下。次设备号用于标识主设备组下的某个特定设备。

### GNU工具

除了由内核控制硬件设备外，操作系统还需要工具来执行一些标准功能，比如控制文件和程序。Linus在创建Linux系统内核时，并没有可用的系统工具。然而他很幸运，就在开发Linux内核的同时，有一群人正在互联网上共同努力，模仿Unix操作系统开发一系列标准的计算机系统工具。

GNU(GNU是GNU’s Not Unix的缩写)项目的主旨在于为Unix系统管理员设计出一套类似于Unix的环境。GNU组织开发了一套完整的Unix工具，但没有可以运行它们的内核系统。将Linus的Linux内核和GNU操作系统工具 整合起来，就产生了一款完整的、功能丰富的免费操作系统。你也会在互联网上看到一些Linux纯粹主义者将其称为GNU/Linux系统，藉此向GNU组织所作的贡献致意。

供Linux系统使用的这组核心工具被称为coreutils(core utilities)软件包。

GNU/Linux shell是一种特殊的交互式工具。它为用户提供了启动程序、管理文件系统中的文件以及运行在Linux系统上的进程的途径。

在Linux系统上，通常有好几种Linux shell可用。不同的shell有不同的特性，有些更利于创建脚本，有些则更利于管理进程。所有Linux发行版默认的shell都是bash shell。bash shell由GNU项目开发，被当作标准Unix shell——Bourne shell(以创建者的名字命名)的替代品。bash shell的名称就是针对Bourne shell的拼写所玩的一个文字游戏，称为Bourne again shell。

## Linux 发行版

我们将完整的Linux系统包称为发行版，例如Red Hat的CentOS和Ubuntu等。
